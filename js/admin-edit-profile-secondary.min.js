!function(e){var o={};function t(n){if(o[n])return o[n].exports;var r=o[n]={i:n,l:!1,exports:{}};return e[n].call(r.exports,r,r.exports,t),r.l=!0,r.exports}t.m=e,t.c=o,t.d=function(e,o,n){t.o(e,o)||Object.defineProperty(e,o,{configurable:!1,enumerable:!0,get:n})},t.r=function(e){Object.defineProperty(e,"__esModule",{value:!0})},t.n=function(e){var o=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(o,"a",o),o},t.o=function(e,o){return Object.prototype.hasOwnProperty.call(e,o)},t.p="",t(t.s=3)}({3:function(e,o,t){"use strict";var n=n||{};n.people=n.people||{},n.people.rest_response_complete=!1,n.people.user_can_edit_profile="",n.people.working_titles="",n.people.degree="",n.people.bio_content={content:"",_wsuwp_profile_bio_unit:"",_wsuwp_profile_bio_university:""},n.people.nid=document.getElementById("_wsuwp_profile_ad_nid"),n.people.populate_profile_from_primary_directory=function(e){document.querySelector(".wsu-person").dataset.nid=e.nid,document.getElementById("_wsuwp_profile_post_id").value=e.id,document.getElementById("_wsuwp_profile_canonical_source").value=e.link,new Map([["name",e.title.rendered],["email",e.email_alt?e.email_alt:e.email],["phone",e.phone_alt?e.phone_alt:e.phone],["office",e.office_alt?e.office_alt:e.office],["address",e.address_alt?e.address_alt:e.address],["website",e.website]]).forEach(function(e,o){document.querySelector(".wsu-person ."+o).textContent=e,document.querySelector(".wsu-person ."+o).dataset.original=e,document.querySelector("[data-for='"+o+"']").value=e}),n.people.populate_profile_titles(e.working_titles?e.working_titles:[e.position_title]),n.people.populate_profile_degrees(e.degree),n.people.populate_profile_photos(e.photos),n.people.populate_profile_biographies(e.content.rendered,e.bio_unit,e.bio_university),n.people.check_permissions(e.id)},n.people.populate_profile_titles=function(e){n.people.working_titles=e.join(",");var o=document.querySelector(".wsu-person-add-title"),t=document.getElementById("local-display-title");e.forEach(function(r,p){var i=document.querySelectorAll(".contact .title")[p];if(i?(i.textContent=r,document.querySelector("[data-for='title']").value=r):o.insertAdjacentHTML("beforebegin",n.people.repeatable_input("title",r)),t.insertAdjacentHTML("beforeend","<option value='"+p+"'>"+r+"</option>"),e.length-1===p){var l=t.dataset.selected.toString();t.size=p+1,1===l.length?t.querySelector("option[value='"+l+"']").selected=!0:2<l.length&&l.split(",").forEach(function(e){t.querySelector("option[value='"+e+"']").selected=!0})}})},n.people.populate_profile_degrees=function(e){n.people.degree=e.join(",");var o=document.querySelector(".wsu-person-add-degree");e.forEach(function(e,t){var r=document.querySelectorAll(".contact .degree")[t];r?(r.textContent=e,r.nextSibling.value=e):o.insertAdjacentHTML("beforebegin",n.people.repeatable_input("degree",e))})},n.people.populate_profile_photos=function(e){if(e){var o=document.querySelector(".wsu-person .photo"),t=document.querySelector("button.wsu-person-add-photo"),r=document.getElementById("local-display-photo");e.forEach(function(e,p){var i=e.thumbnail,l=p===r.dataset.selected?" checked='checked'":"";t.insertAdjacentHTML("beforebegin",n.people.photo_input(i,"")),r.insertAdjacentHTML("beforeend","<label><input type='radio' name='_use_photo' value='"+p+"'"+l+"/><img src='"+i+"' /></label>"),o.classList.contains("wsu-person-add-photo")&&(o.classList.remove("wsu-person-add-photo"),o.insertAdjacentHTML("afterbegin","<img src='"+i+"'>"),document.querySelector(".photo figcaption").textContent="Manage photo collection")})}},n.people.populate_profile_biographies=function(e,o,t){!1!==n.people.rest_response_complete&&""!==n.people.user_can_edit_profile?new Map([["content",e],["_wsuwp_profile_bio_unit",o],["_wsuwp_profile_bio_university",t]]).forEach(function(e,t){n.people.bio_content[t]=e,!n.people.user_can_edit_profile&&document.getElementById(t)&&(document.getElementById(t).disabled=!0,document.querySelectorAll(".quicktags-toolbar [type='button']").forEach(function(e){e.disabled=!0})),"read-only"===n.people.check_editor_mode(t)?document.querySelector(".wsu-person-bio."+t+" .readonly").insertAdjacentHTML("beforeend",o):document.getElementById(t).value=e}):setTimeout(n.people.populate_profile_biographies.bind(null,e,o,t),200)},n.people.populate_editor=function(e){!1!==n.people.rest_response_complete&&""!==n.people.user_can_edit_profile?"visual"===n.people.check_editor_mode(e.id)&&(window.tinymce.get(e.id).setContent(n.people.bio_content[e.id]),n.people.user_can_edit_profile||window.tinymce.get(e.id).setMode("readonly")):setTimeout(n.people.populate_editor.bind(null,e),200)},n.people.check_permissions=function(e){var o=window.wsuwp_people_edit_profile_secondary.rest_url+"/"+e,t={method:"POST",credentials:"same-origin",headers:{"X-WP-Nonce":window.wsuwp_people_edit_profile_secondary.nonce,"X-WSUWP-UID":window.wsuwp_people_edit_profile_secondary.uid}};fetch(o,t).then(n.people.set_permissions).then(function(e){return window.console.log(e)}).catch(function(e){return window.console.log(e)}),n.people.rest_response_complete=!0},n.people.set_permissions=function(e){return e.json().then(function(o){return e.ok?(n.people.user_can_edit_profile=!0,o):(n.people.user_can_edit_profile=!1,document.querySelectorAll(".wsu-person [contenteditable='true']").forEach(function(e){e.contentEditable=!1}),document.querySelectorAll(".wsu-person-remove").forEach(function(e){e.remove()}),document.querySelectorAll(".wsu-person-add-repeatable-meta").forEach(function(e){e.remove()}),window.tinymce.get("content")&&window.tinymce.get("content").setMode("readonly"),Promise.reject(Object.assign({},o,{status:e.status,statusText:e.statusText})))})},n.people.update_primary_profile=function(){var e={};if(new Map([["title",document.querySelector(".wsu-person .name")],["email_alt",document.querySelector(".wsu-person .email")],["phone_alt",document.querySelector(".wsu-person .phone")],["office_alt",document.querySelector(".wsu-person .office")],["address_alt",document.querySelector(".wsu-person .address")],["website",document.querySelector(".wsu-person .website")]]).forEach(function(o,t){o.textContent!==o.dataset.original&&(e[t]=o.textContent)}),new Map([["working_titles",document.querySelectorAll(".wsu-person .title")],["degree",document.querySelectorAll(".wsu-person .degree")]]).forEach(function(o,t){if(o){var r=Array.prototype.slice.call(o).map(function(e){return e.textContent}).join(",");r!==n.people[t]&&(e[t]=r)}}),new Map([["content","content"],["bio_unit","_wsuwp_profile_bio_unit"],["bio_university","_wsuwp_profile_bio_university"]]).forEach(function(o,t){if("read-only"!==n.people.check_editor_mode(o)){var r=document.getElementById(o).value;r!==n.people.bio_content[o]&&(e[t]=r)}}),!n.people.is_empty_object(e)){var o=document.getElementById("_wsuwp_profile_post_id").value,t=window.wsuwp_people_edit_profile_secondary.rest_url+"/"+o,r={method:"POST",credentials:"same-origin",body:e,headers:{"Content-Type":"application/x-www-form-urlencoded; charset=utf-8","X-WP-Nonce":window.wsuwp_people_edit_profile_secondary.nonce,"X-WSUWP-UID":window.wsuwp_people_edit_profile_secondary.uid}};fetch(t,r)}},n.people.check_editor_mode=function(e){var o=document.getElementById("wp-"+e+"-wrap");return o?o.classList.contains("html-active")?"text":"visual":"read-only"},window.wsuwp_people_edit_profile_secondary.load_data&&n.people.nid.value&&(fetch(window.wsuwp_people_edit_profile_secondary.rest_url+"?wsu_nid="+n.people.nid.value).then(function(e){return e.json()}).then(function(e){n.people.populate_profile_from_primary_directory(e[0])}),document.getElementById("publish").addEventListener("click",function(){n.people.user_can_edit_profile&&n.people.update_primary_profile()}))}});